# Blockpass SdkWeb

## Structures
This packages contains:
- ES6 source code `src/`
- Transpiler for node (below 6) `dist/node`
- Transpiler for web-browser `dist/browser`

## Getting Start (browser)

1. Add blockpass-web package via `<script>` tag
``` html
    <script src="../dist/browser/blockpass.dev.js"></script>
```

2. Init SDK
``` javascript

const clientId = '...'
const secretId = '...'
const baseUrl = '...'

sdk = new window.Blockpass.WebSDK({
    clientId,
    secretId,
    baseUrl,
    refreshRateMs: 1000
})
```

3. Subcrible event handler
``` javascript

function onBlockpassCodeRefresh(params) {
    // session code ready to use now

    // demo qrcode images ( using demo online qrserver ). For production don't use this api
    document.getElementById('step1-qr').src = `http://api.qrserver.com/v1/create-qr-code/?data=${JSON.stringify(params)}`
}

function onBlockpassProcessing(params) {
    // session code invalid from now
    // Show loading indicator
}

function onBlockpassSSoResult(params) {
    // sso complete. handle your logic here
}

sdk.on('code-refresh', onBlockpassCodeRefresh)
sdk.on('sso-processing', onBlockpassProcessing)
sdk.on('sso-complete', onBlockpassSSoResult)

// request for new sso code
sdk.generateSSOData();
```

## Development Instalation

```sh
$ yarn install
```

## Development Commands

```sh
$ npm test # run tests with Jest
$ npm run coverage # run tests with coverage and open it on browser
$ npm run lint # lint code
$ npm run docs # generate docs
$ npm run build # generate docs and transpile code
$ npm run watch # watch code changes and run scripts automatically
```

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

#### Table of Contents

-   [WebSDK](#websdk)
    -   [generateSSOData](#generatessodata)
-   [ConstructorParams](#constructorparams)
-   [WebSDK#code-refresh](#websdkcode-refresh)
-   [WebSDK#sso-processing](#websdksso-processing)
-   [WebSDK#sso-complete](#websdksso-complete)

### WebSDK

**Extends EventEmitter**

Blockpass WebSDK

**Parameters**

-   `configData` **...[ConstructorParams](#constructorparams)** 

#### generateSSOData

Generate new SSO code and monitor status

### 

* * *

### ConstructorParams

Type: [object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)

**Properties**

-   `baseUrl` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Blockpass url.
-   `clientId` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Blockpass ClientId.
-   `secretId` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Blockpass SecretId.
-   `refreshRateMs` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** Refreshrate in miliseconds (default-5000).

### WebSDK#code-refresh

Session code generated. Session code is one time use. Life cycles (created -> processing -> success|failed)
Client must refresh code after sso failed / timeout

Type: [object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)

**Properties**

-   `session` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** sessionID

### WebSDK#sso-processing

Session code switch to processing

Type: [object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)

**Properties**

-   `status` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** status of session code

### WebSDK#sso-complete

Session code switch to processing

Type: [object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)

**Properties**

-   `status` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** status of session code (success|failed)
-   `extraData` **[object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** extraData
    -   `extraData.sessionData` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** session code
    -   `extraData.extraData` **[object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** services extraData

## License

MIT
